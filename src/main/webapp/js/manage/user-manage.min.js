$(document).ready(function(){getAllUser();$("#addUser").click(function(){var userCode=$.trim(("#addUserCode").val());var userName=$.trim($("#addUserName").val());var userEmail=$.trim($("#addUserEmail").val());if($.isEmptyObject(userCode)||$.isEmptyObject(userName)||$.isEmptyObject(userEmail)){Materialize.toast("所有项目都必须填写！",3000,"rounded red");return}$.post({url:"user/add",data:{"userCode":userCode,"userName":userName,"userEmail":userEmail},success:function(data){Materialize.toast(data,3000,"rounded teal lighten-2")}})});$("#conditionSearch").click(function(){var usercode=$.trim($("input[name='userCode']").val());var username=$.trim($("input[name='userName']").val());var usersex=$.trim($("select[name=userSex]").val());var useremail=$.trim($("input[name='userEmail']").val());usercode=$.isEmptyObject(usercode)?"_":usercode;username=$.isEmptyObject(username)?"_":username;useremail=$.isEmptyObject(useremail)?"_":useremail;var url="user/search/"+usercode+"/"+username+"/"+useremail+"/"+usersex+"/";if($.isEmptyObject(usersex)){url="user/search/"+usercode+"/"+username+"/"+useremail+"/"}$.get({url:url+1+"/"+10,success:function(data){$("#progree").removeClass("hide");listUser(data);slipPage(url,data)}})});$("#searchByKey").submit(function(){var key=$("#search").val();key=$.isEmptyObject(key)?"_":key;var url="user/search/"+key;$.get({url:url+"/1/10",success:function(data){$("#progree").removeClass("hide");listUser(data);slipPage(url,data)}});return false});$("#list").on("click",function(event){var urlLink=getEventTarget(event);if($(urlLink).hasClass("delete")){var url=urlLink.getAttribute("data-url");$.post({url:url,data:{_method:"delete"},success:function(data){Materialize.toast(data)}})}});$("#slip").on("click",function(){var li=getEventTarget(event);if(li.tagName=="I"||li.tagName=="A"){var url=li.parentElement.parentElement.getAttribute("data-url");var index=li.getAttribute("data-url");$.get({url:url+index,success:function(data){$("#progree").removeClass("hide");listUser(data);slipPage(url,data)}})}})});function listUser(data){var listView=$("#list");listView.empty();var userList=data.list;if(userList.length>0&&listView.hasClass("hide")){listView.removeClass("hide")}else if(userList.length<=0&&!listView.hasClass("hide")){listView.addClass("hide")}for(let user of userList){listView.append("<li><div class='collapsible-header'>"+user.userName+"</div><div class='collapsible-body'><p><div class='col l3'><label>code：</label><span>"+user.userCode+"</span></div><div class='col l2'><label>性别：</label><span>"+user.userSex+"</span></div><div class='col l4'><label>Email：</label><span>"+user.userEmail+"</span></div><div class='col l3'><button class='delete btn right' data-url='user/delete/"+user.userId+"'><i class='material-icons'>delete_forever</i></button></div></p></div></li>")}$("#progree").addClass("hide")}function getAllUser(){var url="user/search/_";$.get({url:url+"/1/10",success:function(data){$("#progree").removeClass("hide");listUser(data);slipPage(url,data)}})}